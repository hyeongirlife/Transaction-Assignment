# TypeScript & NestJS 스타일 가이드 (한글 번역)

---

## TypeScript 일반 가이드라인

### 기본 원칙

- 모든 코드와 문서는 영어로 작성한다.
- 모든 변수와 함수(파라미터 및 반환값)의 타입을 반드시 선언한다.
- any 사용을 피한다.
- 필요한 타입을 생성한다.
- 공개 클래스와 메서드는 JSDoc으로 문서화한다.
- 함수 내에 빈 줄을 남기지 않는다.
- 함수는 한 가지 목적만 갖도록 짧게 작성한다(20줄 미만).
- 파일 및 디렉토리 이름은 kebab-case를 사용한다.
- 환경 변수는 UPPERCASE를 사용한다.
- 매직 넘버를 피하고 상수로 정의한다.
- 함수는 동사로 시작한다.
- 불리언 변수는 isLoading, hasError, canDelete 등 동사를 사용한다.
- 약어 대신 전체 단어를 사용하고, 올바른 철자를 사용한다.
- 표준 약어(API, URL 등)와 잘 알려진 약어(i, j(루프), err(에러), ctx(컨텍스트), req/res/next(미들웨어))는 예외로 한다.

### 명명 규칙

- 클래스는 PascalCase를 사용한다.
- 변수, 함수, 메서드는 camelCase를 사용한다.
- 파일 및 디렉토리는 kebab-case를 사용한다.
- 환경 변수는 UPPERCASE를 사용한다.

### 함수

- 함수(메서드 포함)는 한 가지 목적만 갖도록 짧게 작성한다(20줄 미만).
- 함수명은 동사+명사 형태로 작성한다.
- 불리언 반환 함수는 isX, hasX, canX 등으로 시작한다.
- 반환값이 없는 함수는 executeX, saveX 등으로 시작한다.
- 블록 중첩을 피하기 위해:
  - 빠른 체크 후 return.
  - 유틸리티 함수로 분리.
- 중첩 함수 대신 고차 함수(map, filter, reduce 등) 사용을 권장한다.
- 간단한 함수(3줄 미만)는 화살표 함수로 작성한다.
- 복잡한 함수는 이름 있는 함수로 작성한다.
- null/undefined 체크 대신 기본 파라미터 값을 사용한다.
- 여러 파라미터는 객체로 전달(RO-RO 패턴).
- 입력/출력 타입을 반드시 선언한다.
- 한 단계의 추상화만 사용한다.

### 데이터

- 원시 타입 남용을 피하고, 복합 타입으로 캡슐화한다.
- 함수 내 데이터 검증을 피하고, 내부 검증이 있는 클래스를 사용한다.
- 데이터는 불변성을 선호한다.
- 변경되지 않는 데이터는 readonly로 선언한다.
- 변경되지 않는 리터럴은 as const로 선언한다.

### 클래스

- SOLID 원칙을 따른다.
- 상속보다 컴포지션을 선호한다.
- 계약을 정의할 때 인터페이스를 선언한다.
- 한 가지 목적만 갖는 작은 클래스를 작성한다(200줄 미만, public 메서드 10개 미만, 프로퍼티 10개 미만).

### 예외 처리

- 예측하지 못한 에러는 예외로 처리한다.
- 예외를 catch할 때는:
  - 예상된 문제를 해결할 때,
  - 컨텍스트를 추가할 때만 사용한다.
  - 그 외에는 글로벌 핸들러를 사용한다.

### 테스트

- 테스트는 Arrange-Act-Assert 패턴을 따른다.
- 테스트 변수는 명확하게 네이밍한다.
- inputX, mockX, actualX, expectedX 등 네이밍 컨벤션을 따른다.
- 각 public 함수마다 단위 테스트를 작성한다.
- 의존성은 테스트 더블로 대체한다(비싼 외부 의존성 제외).
- 각 모듈마다 인수 테스트를 작성한다.
- Given-When-Then 패턴을 따른다.

---

## NestJS 전용

### 기본 원칙

- 모듈형 아키텍처를 사용한다.
- API는 모듈로 캡슐화한다.
  - 주요 도메인/라우트마다 하나의 모듈.
  - 각 라우트마다 하나의 컨트롤러.
  - 보조 라우트는 별도 컨트롤러.
  - 데이터 타입은 models 폴더에.
  - 입력은 class-validator로 검증된 DTO 사용.
  - 출력은 단순 타입 선언.
  - 비즈니스 로직과 영속성은 services 모듈에.
  - 데이터 영속성은 MikroORM의 엔티티로.
  - 엔티티마다 하나의 서비스.
- 코어 모듈에는 nest 아티팩트 포함
  - 예외 처리를 위한 글로벌 필터.
  - 요청 관리를 위한 글로벌 미들웨어.
  - 권한 관리를 위한 가드.
  - 요청 관리를 위한 인터셉터.
- 공유 모듈에는 여러 모듈에서 공유하는 서비스 포함
  - 유틸리티
  - 공유 비즈니스 로직

### 테스트

- 표준 Jest 프레임워크를 사용한다.
- 각 컨트롤러와 서비스마다 테스트를 작성한다.
- 각 API 모듈마다 end-to-end 테스트를 작성한다.
- 각 컨트롤러에 admin/test 메서드를 추가해 스모크 테스트를 한다.
